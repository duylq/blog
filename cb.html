<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hướng Dẫn Tương Tác về Aptomat (CB)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Visualization & Content Choices:
        - Report Intro -> Goal: Inform -> Presentation: Text, Unicode Icons -> Interaction: None -> Justification: Clear, concise intro.
        - In (Dòng điện định mức) -> Goal: Inform/Compare -> Presentation: Text, HTML styled examples (C16) -> Interaction: Click to see typical devices (conceptual) -> Justification: Relate abstract number to real life.
        - Ue, Ui, Uimp (Điện áp) -> Goal: Inform/Compare -> Presentation: Text, HTML styled info boxes/comparison table -> Interaction: Hover for tooltips -> Justification: Clarify distinct voltage ratings.
        - Icu & Ics (Khả năng cắt) -> Goal: Compare -> Viz: Chart.js Bar Chart (Canvas) comparing Icu and Ics values for different quality CBs -> Interaction: Tooltips on bars -> Justification: Visually show difference in "robustness".
        - Poles (1P, 2P) -> Goal: Inform/Compare -> Presentation: Text, HTML/CSS diagram (simple line art style) -> Interaction: Toggle/Click to highlight differences -> Justification: Visual explanation of wiring.
        - Trip Curves (B, C, D) -> Goal: Compare/Inform -> Viz: Chart.js Line Chart (Canvas) showing conceptual curves -> Interaction: Click curve to see typical applications/load types -> Justification: Visualize sensitivity.
        - IP Rating -> Goal: Inform/Organize -> Presentation: HTML Table (from report), Unicode icons -> Interaction: Click IP code for example scenario -> Justification: Easy lookup and context.
        - Current Calculator (I=P/U) -> Goal: Apply/Inform -> Presentation: HTML form, JS calculation -> Interaction: User input for P, U, Cosφ; display I and recommended CB In -> Justification: Practical tool.
        - Wire Sizing (Ib < In < Iz) -> Goal: Inform/Apply -> Presentation: HTML Table (from report), HTML/CSS diagram for rule -> Interaction: Select wire, see CB -> Justification: Safety critical info.
        - Conclusion/Tips -> Goal: Inform -> Presentation: Text, styled lists -> Interaction: None -> Justification: Summarize key advice.
        - CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. All diagrams by HTML/CSS/Unicode. Charts by Chart.js (Canvas).
    -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF7; /* Warm Off-White */
            color: #3A3A3A; /* Dark Gray */
        }
        .tab-button {
            background-color: #FFFFFF; /* Card Background */
            color: #5D7B6F; /* Muted Sage Green */
            border: 1px solid #5D7B6F;
            transition: all 0.3s ease;
        }
        .tab-button.active, .tab-button:hover {
            background-color: #5D7B6F; /* Muted Sage Green */
            color: #FFFFFF;
        }
        .section-title {
            color: #5D7B6F; /* Muted Sage Green */
            border-bottom: 2px solid #A0A083; /* Muted Olive */
            padding-bottom: 0.5rem;
        }
        .card {
            background-color: #FFFFFF; /* Card Background */
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0,0,0,0.1);
        }
        .parameter-card h3 {
            color: #5D7B6F;
        }
        .parameter-card .icon {
            font-size: 2rem;
            color: #A0A083;
        }
        .calculator input, .calculator select {
            border: 1px solid #A0A083;
            color: #3A3A3A;
        }
        .calculator button {
            background-color: #5D7B6F;
            color: #FFFFFF;
        }
        .calculator button:hover {
            background-color: #4A6B5D;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px; /* Adjusted max-width */
            margin-left: auto;
            margin-right: auto;
            height: 280px; /* Base height */
            max-height: 320px; /* Max height */
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 320px;
                max-height: 350px;
            }
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #E0E0E0; /* Light Gray Border */
            padding: 0.75rem;
            text-align: left;
        }
        th {
            background-color: #E9EBEA; /* Very Light Sage */
            color: #5D7B6F; /* Muted Sage Green */
        }
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: pointer;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 220px;
            background-color: #3A3A3A;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -110px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.875rem;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        .pole-diagram {
            display: flex;
            align-items: center;
            justify-content: space-around;
            padding: 1rem;
            border: 1px solid #A0A083;
            border-radius: 0.25rem;
            background-color: #F9F9F9;
        }
        .pole-diagram .wire {
            height: 80px;
            width: 5px;
            margin: 0 10px;
        }
        .pole-diagram .l-wire { background-color: #D32F2F; /* Red for Line */}
        .pole-diagram .n-wire { background-color: #1976D2; /* Blue for Neutral */}
        .pole-diagram .switch {
            width: 20px;
            height: 10px;
            border: 2px solid #3A3A3A;
            position: relative;
            background-color: #fff;
        }
        .pole-diagram .switch.closed::before {
            content: '';
            position: absolute;
            top: 2px;
            left: -10px;
            width: 18px;
            height: 2px;
            background-color: #3A3A3A;
            transform: rotate(-45deg);
            transform-origin: right;
        }
         .interactive-list li {
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.25rem;
            transition: background-color 0.2s ease;
        }
        .interactive-list li:hover {
            background-color: #E9EBEA;
        }
        .interactive-list li.active-info {
            background-color: #A0A083;
            color: white;
        }
        .info-box {
            border-left: 4px solid #5D7B6F;
            padding: 1rem;
            background-color: #F0F3F2;
            margin-top: 0.5rem;
        }

    </style>
</head>
<body class="min-h-screen">

    <header class="bg-[#5D7B6F] text-white p-6 shadow-md">
        <div class="container mx-auto text-center">
            <h1 class="text-3xl md:text-4xl font-bold">Hướng Dẫn Tương Tác về Aptomat (CB)</h1>
            <p class="mt-2 text-lg">Hiểu rõ các thông số để lựa chọn an toàn và hiệu quả</p>
        </div>
    </header>

    <nav class="bg-[#A0A083] shadow-lg sticky top-0 z-50">
        <div class="container mx-auto flex flex-wrap justify-center p-2" id="tab-navigation">
            <button class="tab-button active py-2 px-4 m-1 rounded-md font-semibold text-sm md:text-base" data-tab="overview">Tổng Quan</button>
            <button class="tab-button py-2 px-4 m-1 rounded-md font-semibold text-sm md:text-base" data-tab="parameters">Giải Mã Thông Số</button>
            <button class="tab-button py-2 px-4 m-1 rounded-md font-semibold text-sm md:text-base" data-tab="selection">Chọn CB Thông Minh</button>
            <button class="tab-button py-2 px-4 m-1 rounded-md font-semibold text-sm md:text-base" data-tab="conclusion">Lưu Ý & Kết Luận</button>
        </div>
    </nav>

    <main class="container mx-auto p-4 md:p-8">
        <section id="overview" class="tab-content">
            <h2 class="text-2xl md:text-3xl font-semibold section-title mb-6">Chào Mừng Đến Với Hướng Dẫn Aptomat!</h2>
            <div class="card p-6 mb-6">
                <p class="mb-4 text-lg">Aptomat (CB - Circuit Breaker) là một thiết bị cực kỳ quan trọng trong mọi gia đình, đóng vai trò như một "người vệ sĩ thầm lặng" cho hệ thống điện. Nó không chỉ là công tắc, mà là một thiết bị an toàn chủ động, tự ngắt mạch khi có sự cố như quá tải hay ngắn mạch, giúp phòng chống cháy nổ và bảo vệ các thiết bị điện đắt tiền của bạn.</p>
                <p class="text-lg">Việc hiểu rõ các ký hiệu và con số trên Aptomat giúp bạn chọn đúng loại phù hợp, đảm bảo an toàn tối đa và tránh những phiền toái không đáng có. Hãy cùng khám phá "ngôn ngữ" của Aptomat!</p>
            </div>
             <div class="grid md:grid-cols-2 gap-6">
                <div class="card p-6">
                    <h3 class="text-xl font-semibold text-[#5D7B6F] mb-3">❓ Tại Sao Cần Hiểu Aptomat?</h3>
                    <ul class="list-disc list-inside space-y-2">
                        <li><strong class="text-[#A0A083]">An Toàn Tuyệt Đối:</strong> Ngăn ngừa nguy cơ cháy nổ, điện giật.</li>
                        <li><strong class="text-[#A0A083]">Bảo Vệ Thiết Bị:</strong> Kéo dài tuổi thọ cho đồ dùng điện.</li>
                        <li><strong class="text-[#A0A083]">Tránh Phiền Toái:</strong> Giảm thiểu tình trạng nhảy Aptomat không mong muốn.</li>
                        <li><strong class="text-[#A0A083]">Lựa Chọn Thông Minh:</strong> Chọn đúng loại CB cho từng nhu cầu cụ thể.</li>
                    </ul>
                </div>
                <div class="card p-6">
                    <h3 class="text-xl font-semibold text-[#5D7B6F] mb-3">💡 Aptomat vs. Cầu Chì</h3>
                    <p class="mb-2">Khác với cầu chì (phải thay thế sau mỗi lần ngắt), Aptomat có thể được bật lại (reset) sau khi sự cố đã được khắc phục.</p>
                    <p><strong class="text-[#A0A083]">Aptomat:</strong> Bảo vệ chủ động, tái sử dụng.</p>
                    <p><strong class="text-[#A0A083]">Cầu chì:</strong> Bảo vệ thụ động, dùng một lần.</p>
                </div>
            </div>
        </section>

        <section id="parameters" class="tab-content hidden">
            <h2 class="text-2xl md:text-3xl font-semibold section-title mb-6">Giải Mã Các Thông Số Quan Trọng</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                
                <div class="parameter-card card p-6">
                    <div class="flex items-center mb-3">
                        <span class="icon mr-3">⚡</span>
                        <h3 class="text-xl font-semibold">Dòng Điện Định Mức (In)</h3>
                    </div>
                    <p class="text-sm mb-2">Là dòng điện tối đa mà CB hoạt động ổn định. Ví dụ: <strong>C16</strong> = 16 Ampe, đặc tuyến C.</p>
                    <p class="text-sm">Hiểu In giúp bạn chọn CB chịu được tải của các thiết bị hàng ngày.</p>
                    <div class="mt-3 p-3 bg-gray-100 rounded">
                        <p class="text-xs font-semibold">Ví dụ ứng dụng cho C16 (16A):</p>
                        <ul class="list-disc list-inside text-xs ml-4">
                            <li>Bình nóng lạnh (khoảng 2500W)</li>
                            <li>Một số loại điều hòa nhỏ</li>
                        </ul>
                    </div>
                </div>

                <div class="parameter-card card p-6">
                     <div class="flex items-center mb-3">
                        <span class="icon mr-3">🛡️</span>
                        <h3 class="text-xl font-semibold">Điện Áp Định Mức (Ue, Ui, Uimp)</h3>
                    </div>
                    <p class="text-sm mb-1"><strong class="text-[#A0A083]">Ue/Un:</strong> Điện áp làm việc (VN: 220V).</p>
                    <p class="text-sm mb-1"><strong class="text-[#A0A083]">Ui:</strong> Điện áp cách điện tối đa.</p>
                    <p class="text-sm mb-2"><strong class="text-[#A0A083]">Uimp:</strong> Khả năng chịu xung điện áp (kV).</p>
                    <p class="text-sm">Đảm bảo CB tương thích và an toàn với điện áp nhà bạn, kể cả khi có xung sét.</p>
                </div>

                <div class="parameter-card card p-6">
                    <div class="flex items-center mb-3">
                        <span class="icon mr-3">💥</span>
                        <h3 class="text-xl font-semibold">Khả Năng Cắt Ngắn Mạch (Icu, Ics)</h3>
                    </div>
                    <p class="text-sm mb-1"><strong class="text-[#A0A083]">Icu:</strong> Dòng ngắn mạch tối đa CB cắt được 1 lần (kA).</p>
                    <p class="text-sm mb-2"><strong class="text-[#A0A083]">Ics:</strong> Dòng ngắn mạch CB cắt được nhiều lần và vẫn dùng tốt (thường là % Icu).</p>
                    <p class="text-sm">Icu/Ics càng cao, CB càng "trâu bò", bảo vệ tốt hơn khi có sự cố nghiêm trọng. Dân dụng thường dùng 4.5kA - 6kA.</p>
                    <div class="chart-container mt-4 h-48 md:h-56">
                        <canvas id="icuIcsChart"></canvas>
                    </div>
                </div>

                <div class="parameter-card card p-6">
                    <div class="flex items-center mb-3">
                        <span class="icon mr-3">🔗</span>
                        <h3 class="text-xl font-semibold">Số Cực (1P, 2P)</h3>
                    </div>
                    <p class="text-sm mb-2"><strong class="text-[#A0A083]">1P:</strong> Bảo vệ 1 dây pha (L). Thường cho đèn, ổ cắm đơn.</p>
                    <p class="text-sm mb-2"><strong class="text-[#A0A083]">2P:</strong> Bảo vệ cả dây pha (L) và trung tính (N). An toàn hơn, dùng cho CB tổng, thiết bị công suất lớn.</p>
                    <div class="grid grid-cols-2 gap-2 mt-3 text-center">
                        <div>
                            <p class="font-semibold text-xs">CB 1P (1 Cực)</p>
                            <div class="pole-diagram">
                                <div class="wire l-wire"></div> <div class="switch closed"></div> <span>Tải</span>
                            </div>
                            <p class="text-xs mt-1">Ngắt dây L</p>
                        </div>
                        <div>
                            <p class="font-semibold text-xs">CB 2P (2 Cực)</p>
                            <div class="pole-diagram">
                                <div class="wire l-wire"></div> <div class="switch closed"></div>
                                <div class="wire n-wire"></div> <div class="switch closed"></div>
                                <span>Tải</span>
                            </div>
                             <p class="text-xs mt-1">Ngắt cả L & N</p>
                        </div>
                    </div>
                </div>
                
                <div class="parameter-card card p-6 lg:col-span-2">
                    <div class="flex items-center mb-3">
                        <span class="icon mr-3">⏱️</span>
                        <h3 class="text-xl font-semibold">Đặc Tuyến Cắt (Type B, C, D)</h3>
                    </div>
                    <p class="text-sm mb-2">Xác định độ nhạy của CB khi có dòng tăng đột ngột. Chọn đúng loại để tránh nhảy "oan" mà vẫn bảo vệ tốt.</p>
                    <ul class="interactive-list text-sm mb-3">
                        <li data-info="typeB"><strong>Type B (3-5 lần In):</strong> Cho tải thuần trở (đèn sợi đốt). Ít dùng ở VN.</li>
                        <li data-info="typeC" class="active-info"><strong>Type C (5-10 lần In):</strong> Phổ biến nhất. Cho điều hòa, máy bơm, quạt. (Mặc định hiển thị)</li>
                        <li data-info="typeD"><strong>Type D (10-20 lần In):</strong> Cho tải công nghiệp nặng (động cơ lớn).</li>
                    </ul>
                    <div id="tripCurveInfo" class="info-box text-sm">
                        <p><strong>Type C:</strong> Đây là lựa chọn cân bằng, phù hợp cho hầu hết các thiết bị gia dụng có động cơ nhỏ hoặc dòng khởi động vừa phải như máy lạnh, tủ lạnh, máy giặt, máy bơm nước gia đình. Nó cho phép dòng khởi động cao hơn Type B một chút mà không ngắt mạch oan, đồng thời vẫn bảo vệ hiệu quả khi có sự cố ngắn mạch thực sự.</p>
                    </div>
                    <div class="chart-container mt-4 h-56 md:h-64">
                        <canvas id="tripCurveChart"></canvas>
                    </div>
                </div>

                <div class="parameter-card card p-6">
                    <div class="flex items-center mb-3">
                        <span class="icon mr-3">💧</span>
                        <h3 class="text-xl font-semibold">Chỉ Số Bảo Vệ IP</h3>
                    </div>
                    <p class="text-sm mb-2">Khả năng chống bụi và nước. Ví dụ: IP20 (trong nhà), IP55 (ẩm nhẹ), IP65 (ngoài trời).</p>
                    <div class="overflow-x-auto text-xs">
                        <table class="min-w-full">
                            <thead>
                                <tr><th>IP</th><th>Chống Bụi</th><th>Chống Nước</th></tr>
                            </thead>
                            <tbody>
                                <tr><td>IP20</td><td>Vật >12.5mm</td><td>Không</td></tr>
                                <tr><td>IP44</td><td>Vật >1mm</td><td>Nước bắn</td></tr>
                                <tr><td>IP55</td><td>Chống bụi (hạn chế)</td><td>Vòi phun áp lực thấp</td></tr>
                                <tr><td>IP65</td><td>Chống bụi hoàn toàn</td><td>Vòi phun áp lực</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <p class="text-sm mt-2">Chọn IP phù hợp với vị trí lắp đặt CB để đảm bảo độ bền.</p>
                </div>
            </div>
        </section>

        <section id="selection" class="tab-content hidden">
            <h2 class="text-2xl md:text-3xl font-semibold section-title mb-6">Chọn CB Thông Minh Cho Gia Đình</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="card p-6 calculator">
                    <h3 class="text-xl font-semibold text-[#5D7B6F] mb-4">⚙️ Công Cụ Tính Dòng Điện & Chọn CB</h3>
                    <p class="text-sm mb-4">Nhập tổng công suất các thiết bị bạn muốn bảo vệ để ước tính dòng điện và CB phù hợp.</p>
                    <div class="space-y-3">
                        <div>
                            <label for="power" class="block text-sm font-medium">Tổng công suất (P - Watt):</label>
                            <input type="number" id="power" placeholder="Ví dụ: 3000" class="mt-1 block w-full p-2 rounded-md">
                        </div>
                        <div>
                            <label for="voltage" class="block text-sm font-medium">Điện áp (U - Volt):</label>
                            <input type="number" id="voltage" value="220" class="mt-1 block w-full p-2 rounded-md">
                        </div>
                        <div>
                            <label for="cosphi" class="block text-sm font-medium">Hệ số công suất (Cosφ):</label>
                            <input type="number" id="cosphi" value="0.8" step="0.1" class="mt-1 block w-full p-2 rounded-md">
                        </div>
                        <button id="calculateBtn" class="w-full py-2 px-4 rounded-md font-semibold">Tính Toán</button>
                    </div>
                    <div id="result" class="mt-4 p-4 bg-gray-100 rounded-md text-center hidden">
                        <p class="text-lg">Dòng điện tính toán (I): <strong id="calculatedCurrent" class="text-[#5D7B6F]">0 A</strong></p>
                        <p class="text-lg">CB đề xuất (In): <strong id="recommendedCB" class="text-[#A0A083]">Chọn CB lớn hơn 0 A</strong></p>
                        <p class="text-xs mt-2">(Đã cộng thêm 30-50% dự phòng)</p>
                    </div>
                </div>

                <div class="card p-6">
                    <h3 class="text-xl font-semibold text-[#5D7B6F] mb-4">📏 Chọn CB Theo Tiết Diện Dây Dẫn</h3>
                    <p class="text-sm mb-2">Nguyên tắc vàng: <strong class="text-[#A0A083]">Ib &lt; In &lt; Iz</strong></p>
                    <ul class="text-sm list-disc list-inside mb-3">
                        <li><strong>Ib:</strong> Dòng tải thực tế.</li>
                        <li><strong>In:</strong> Dòng định mức CB.</li>
                        <li><strong>Iz:</strong> Khả năng chịu tải tối đa của dây.</li>
                    </ul>
                    <p class="text-sm mb-3">CB phải nhỏ hơn khả năng chịu tải của dây để bảo vệ dây không bị quá nhiệt, nóng chảy.</p>
                    <div class="overflow-x-auto text-sm">
                        <table>
                            <thead>
                                <tr><th>Tiết diện dây (mm²)</th><th>Công suất tối đa (W)</th><th>CB đề xuất (A)</th></tr>
                            </thead>
                            <tbody>
                                <tr><td>1.5</td><td>~2300</td><td>10A</td></tr>
                                <tr><td>2.5</td><td>~3600</td><td>16A</td></tr>
                                <tr><td>4</td><td>~5700</td><td>25A</td></tr>
                                <tr><td>6</td><td>~7300</td><td>32A</td></tr>
                                <tr><td>10</td><td>~10000</td><td>40A</td></tr>
                            </tbody>
                        </table>
                         <p class="text-xs mt-2 italic">*Bảng tham khảo cho điện 1 pha 220V. Luôn kiểm tra với thợ điện chuyên nghiệp.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="conclusion" class="tab-content hidden">
            <h2 class="text-2xl md:text-3xl font-semibold section-title mb-6">Lưu Ý Quan Trọng & Kết Luận</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="card p-6">
                    <h3 class="text-xl font-semibold text-[#5D7B6F] mb-3">✅ Những Điều Nên Làm</h3>
                    <ul class="list-disc list-inside space-y-2 text-sm">
                        <li>Sử dụng CB tổng cho cả nhà và CB nhánh cho từng khu vực/thiết bị lớn.</li>
                        <li>Chọn CB từ thương hiệu uy tín (Panasonic, Sino, Schneider, Mitsubishi Electric...).</li>
                        <li>Kiểm tra thông số trên CB phải rõ ràng, sắc nét.</li>
                        <li>Đảm bảo CB có đặc tuyến cắt Type C cho hầu hết các ứng dụng gia đình.</li>
                        <li>Tham khảo ý kiến thợ điện chuyên nghiệp nếu không chắc chắn.</li>
                    </ul>
                </div>
                <div class="card p-6">
                    <h3 class="text-xl font-semibold text-[#5D7B6F] mb-3">❌ Những Điều Cần Tránh</h3>
                     <ul class="list-disc list-inside space-y-2 text-sm">
                        <li>Chọn CB quá nhỏ: Sẽ nhảy liên tục, gây phiền toái, có thể hỏng CB hoặc thiết bị.</li>
                        <li>Chọn CB quá lớn: Không bảo vệ được dây dẫn và thiết bị khi có sự cố nhỏ, nguy cơ cháy nổ.</li>
                        <li>Mua CB không rõ nguồn gốc, chất lượng kém.</li>
                        <li>Tự ý lắp đặt nếu không có kiến thức chuyên môn.</li>
                    </ul>
                </div>
            </div>
            <div class="card p-6 mt-8 text-center bg-[#E9EBEA]">
                <h3 class="text-2xl font-semibold text-[#5D7B6F] mb-4">Lời Kết</h3>
                <p class="text-lg mb-3">Hiểu rõ Aptomat là bạn đang trang bị cho mình kiến thức để bảo vệ an toàn cho tổ ấm và tài sản. Một chiếc CB phù hợp, chất lượng tốt là khoản đầu tư nhỏ mang lại sự an tâm lớn.</p>
                <p class="text-lg font-semibold text-[#A0A083]">An toàn điện là trên hết!</p>
            </div>
        </section>
    </main>

    <footer class="bg-[#3A3A3A] text-white text-center p-6 mt-12">
        <p>&copy; <span id="currentYear"></span> Hướng dẫn tương tác Aptomat. Thông tin chỉ mang tính tham khảo.</p>
    </footer>

    <script>
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        const tabs = document.querySelectorAll('.tab-button');
        const contents = document.querySelectorAll('.tab-content');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(item => item.classList.remove('active'));
                tab.classList.add('active');
                
                const target = tab.getAttribute('data-tab');
                contents.forEach(content => {
                    if (content.id === target) {
                        content.classList.remove('hidden');
                    } else {
                        content.classList.add('hidden');
                    }
                });
            });
        });

        // Calculator Logic
        const calculateBtn = document.getElementById('calculateBtn');
        if (calculateBtn) {
            calculateBtn.addEventListener('click', () => {
                const power = parseFloat(document.getElementById('power').value);
                const voltage = parseFloat(document.getElementById('voltage').value) || 220;
                const cosphi = parseFloat(document.getElementById('cosphi').value) || 0.8;
                const resultDiv = document.getElementById('result');
                const calculatedCurrentEl = document.getElementById('calculatedCurrent');
                const recommendedCBEl = document.getElementById('recommendedCB');

                if (isNaN(power) || power <= 0) {
                    alert('Vui lòng nhập công suất hợp lệ.');
                    resultDiv.classList.add('hidden');
                    return;
                }

                const current = power / (voltage * cosphi);
                const recommendedInMin = current * 1.3; // Add 30%
                const recommendedInMax = current * 1.5; // Add 50%
                
                // Suggest common CB ratings
                const commonCBs = [6, 10, 16, 20, 25, 32, 40, 50, 63];
                let suggestedCB = commonCBs.find(cb => cb >= recommendedInMin);
                if (!suggestedCB && commonCBs.length > 0) { // if calculated is too high for common list
                    suggestedCB = Math.ceil(recommendedInMin / 5) * 5; // round up to nearest 5A
                }


                calculatedCurrentEl.textContent = current.toFixed(2) + ' A';
                if (suggestedCB) {
                     recommendedCBEl.textContent = `~${suggestedCB}A (Type C)`;
                } else {
                     recommendedCBEl.textContent = `>${recommendedInMin.toFixed(0)}A (Type C)`;
                }
                resultDiv.classList.remove('hidden');
            });
        }
        
        // Tooltip for Chart.js labels
        const tooltipTitleCallback = function(tooltipItems) {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
              return label.join(' ');
            }
            return label;
        };

        // Function to wrap labels for Chart.js
        function wrapChartLabels(label, maxWidth = 16) {
            if (typeof label !== 'string') return label; // Already wrapped or not a string
            const words = label.split(' ');
            let lines = [];
            let currentLine = '';
            for (let word of words) {
                if ((currentLine + word).length > maxWidth && currentLine.length > 0) {
                    lines.push(currentLine.trim());
                    currentLine = word + ' ';
                } else {
                    currentLine += word + ' ';
                }
            }
            if (currentLine.trim().length > 0) {
                lines.push(currentLine.trim());
            }
            return lines.length > 0 ? lines : [label]; // Return original if no wrapping needed
        }


        // Icu/Ics Chart
        const icuIcsCtx = document.getElementById('icuIcsChart');
        if (icuIcsCtx) {
            new Chart(icuIcsCtx.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: [wrapChartLabels('CB Chất Lượng Cao'), wrapChartLabels('CB Phổ Thông')],
                    datasets: [
                        {
                            label: 'Icu (kA)',
                            data: [6, 4.5],
                            backgroundColor: '#5D7B6F', // Muted Sage Green
                        },
                        {
                            label: 'Ics (kA)',
                            data: [6 * 0.75, 4.5 * 0.5], // Assuming Ics = 75% and 50% Icu
                            backgroundColor: '#A0A083', // Muted Olive
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'kA' } } },
                    plugins: { legend: { position: 'top' }, tooltip: { callbacks: { title: tooltipTitleCallback } } }
                }
            });
        }

        // Trip Curve Chart (Conceptual)
        const tripCurveCtx = document.getElementById('tripCurveChart');
        if (tripCurveCtx) {
            const tripCurveChartInstance = new Chart(tripCurveCtx.getContext('2d'), {
                type: 'line',
                data: {
                    labels: ['1xIn', '3xIn', '5xIn', '7xIn', '10xIn', '15xIn', '20xIn'],
                    datasets: [
                        {
                            label: 'Type B (Rất nhạy)',
                            data: [null, 10, 1, 0.1, null, null, null], // Conceptual time to trip
                            borderColor: '#FFB74D', // Orange
                            tension: 0.1,
                            hidden: true
                        },
                        {
                            label: 'Type C (Phổ biến)',
                            data: [null, null, 10, 1, 0.1, 0.05, null],
                            borderColor: '#5D7B6F', // Muted Sage Green
                            tension: 0.1,
                            hidden: false // Default visible
                        },
                        {
                            label: 'Type D (Ít nhạy)',
                            data: [null, null, null, null, 10, 1, 0.1],
                            borderColor: '#A0A083', // Muted Olive
                            tension: 0.1,
                            hidden: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { 
                            type: 'logarithmic', // Logarithmic scale for time
                            title: { display: true, text: 'Thời gian tác động (giây - log)' },
                            min: 0.01,
                            max: 1000
                        },
                        x: { title: { display: true, text: 'Bội số dòng định mức (In)' } }
                    },
                    plugins: { 
                        legend: { position: 'top' },
                        tooltip: { callbacks: { title: tooltipTitleCallback } }
                    }
                }
            });
            
            // Interactive Trip Curve Info
            const tripCurveListItems = document.querySelectorAll('#parameters .interactive-list li');
            const tripCurveInfoBox = document.getElementById('tripCurveInfo');

            const tripCurveDetails = {
                typeB: "<strong>Type B:</strong> Rất nhạy, tác động ở 3-5 lần dòng định mức (In). Phù hợp cho tải thuần trở như đèn sợi đốt, bếp điện. Ít phổ biến ở Việt Nam do nhiều thiết bị có dòng khởi động cao hơn.",
                typeC: "<strong>Type C:</strong> Phổ biến nhất, tác động ở 5-10 lần In. Lý tưởng cho các thiết bị gia dụng có động cơ nhỏ hoặc dòng khởi động vừa phải như máy lạnh, tủ lạnh, máy bơm nước. Cân bằng giữa bảo vệ và tránh nhảy oan.",
                typeD: "<strong>Type D:</strong> Ít nhạy nhất, tác động ở 10-20 lần In. Dùng cho các thiết bị công nghiệp có dòng khởi động rất lớn như động cơ công suất cao, máy biến áp, máy hàn."
            };

            tripCurveListItems.forEach(item => {
                item.addEventListener('click', () => {
                    tripCurveListItems.forEach(i => i.classList.remove('active-info'));
                    item.classList.add('active-info');
                    const type = item.getAttribute('data-info');
                    tripCurveInfoBox.innerHTML = tripCurveDetails[type] || "Chọn một loại đặc tuyến để xem thông tin.";

                    // Update chart visibility
                    tripCurveChartInstance.data.datasets.forEach(dataset => {
                        if (dataset.label.toLowerCase().includes(type.replace('type','').toLowerCase())) {
                            dataset.hidden = false;
                        } else {
                            dataset.hidden = true;
                        }
                    });
                    tripCurveChartInstance.update();
                });
            });
             // Set initial info for Type C
            tripCurveInfoBox.innerHTML = tripCurveDetails['typeC'];

        }


    </script>
</body>
</html>
